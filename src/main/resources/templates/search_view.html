<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>검색결과 | 먹코살코</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
          crossorigin="anonymous">
    <!-- 파비콘 설정 -->
    <link rel="shortcut icon" th:href="@{/images/mini_logo.jpg}">
    <!-- 커스텀 CSS -->
    <link rel="stylesheet" href="/css/search.css">
</head>

<body>
<!-- 헤더: 로고와 네비게이션 -->
<div class="header">
    <div class="container-inner">
        <div class="logo">
            <img th:src="@{/images/main_logo.png}" alt="Main Logo">
            <h1>먹코살코</h1>
        </div>
        <nav class="nav" id="mainNav">
            <a th:href="@{/home}">홈</a>
            <a th:href="@{/intro}">팀원 소개</a>
            <a th:href="@{/suggestion}">문의</a>
            <!-- 드롭다운 메뉴 추가 -->
            <div class="dropdown">
                <button id="userMenuButton">▼</button>
                <div class="dropdown-content" id="userMenu">
                    <!-- 로그인 전 메뉴 -->
                    <th:block th:if="${#strings.isEmpty(session.loggedInUser)}">
                        <a th:href="@{/login}" id="loginLink">로그인</a>
                    </th:block>
                    <!-- 로그인 후 메뉴 -->
                    <th:block th:if="${session.loggedInUser != null}">
                        <th:block th:switch="${session.loggedInUser.roleId}">
                            <!-- 관리자 메뉴 -->
                            <th:block th:case="2">
                                <a th:href="@{/admin/create/store}" id="createLink">가게 등록</a>
                                <a th:href="@{/admin/register/owner}" id="registerLink">사장 등록</a>
                                <a th:href="@{/editprofile}" id="profileLink">내 정보 페이지</a>
                                <a th:href="@{/logout}" id="logoutLink">로그아웃</a>
                            </th:block>
                            <!-- 일반 유저 메뉴 -->
                            <th:block th:case="*">
                                <a th:href="@{/editprofile}" id="profileLink">내 정보 페이지</a>
                                <a th:href="@{/logout}" id="logoutLink">로그아웃</a>
                            </th:block>
                        </th:block>
                    </th:block>
                </div>
            </div>
        </nav>
    </div>
</div>

<div id="wrapHome" class="search_wrap">
    <hr class="hide">
    <div class="wrap_search_header">
        <div class="wrap_search">
            <h2 class="screen_out">검색 키워드 입력 창</h2>
            <div class="search_form">
                <form method="get" action="/search" accept-charset="utf-8">
                    <input type="text" name="q" class="txt_search" id="txt_search" title="검색어입력"
                           placeholder="검색어를 입력해 주세요." maxlength="20"
                           th:value="${searchResult.query}">
                    <input type="hidden" value="article" name="type" id="hdn_search_type">
                    <button type="submit" class="btn btn-search">검색</button>
                </form>
            </div>
        </div>
    </div>

    <div id="searchWrap">
        <div class="search_header">
            <div class="tab_search">
                <ul id="contentsTab" class="inner_tab">
                    <li class="on"><a href="#mArticle" class="articleTab link_tab">식당</a></li>
                    <li><a href="#mReview" class="magazineTab link_tab">리뷰</a></li>
                </ul>
            </div>
        </div>

        <!-- 식당 검색 결과 -->
        <div id="mArticle" style="display: block;">
            <div id="resultArticle" class="search_result" style="display: block; margin-top: 0px;">
                <div class="result_search">
                    <div class="search-result">
                        <span>검색 결과 : </span>
                        <span th:text="${searchResult.storeCount + searchResult.reviewCount}">0</span>
                        <span> 건</span>
                    </div>
                    <div class="result-sort">
                        <a href="#none"><span>최신순</span></a>
                        <a href="#none"><span>평점순</span></a>
                    </div>
                    <section class="food_section layout_padding-bottom">
                        <div class="container">
                            <!-- 가게 검색 결과 -->
                            <div class="filters-content">
                                <div class="row grid">
                                    <th:block th:each="store : ${searchResult.storeResults}">
                                        <div th:class="'col-sm-6 col-lg-4 all ' + ${store.categoryName}">
                                            <div class="box">
                                                <a th:href="@{'/store/' + ${store.storeId}}">
                                                    <div class="img-box">
                                                        <img th:src="@{${store.storePhoto}}" alt="가게 사진">
                                                    </div>
                                                    <div class="detail-box">
                                                        <h5 th:text="${store.storeName}">가게 이름</h5>
                                                        <div class="detail-desc-info">
                                                            <p th:text="${store.storeDescription}">가게 설명</p>
                                                            <div class="detail-rate">
                                                                <ul>
                                                                    <li>
                                                                        <img width="48" height="48"
                                                                             src="https://img.icons8.com/color/48/filled-star--v1.png"
                                                                             alt="filled-star--v1" class="icon_star"/>
                                                                    </li>
                                                                    <li>
                                                                        <span class="rate_num" th:text="${store.ratingAvg}">4.5</span>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                    </th:block>
                                </div>
                            </div>
                            <div class="btn-box">
                                <a href="#none">
                                    더보기
                                </a>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>

        <!-- 리뷰 검색 결과 -->
        <div id="mReview" style="display: none;">
            <div id="resultReview" class="search_result" style="display: block; margin-top: 0px;">
                <div class="result_search">
                    <div class="search-result">
                        <span>검색 결과 : </span>
                        <span th:text="${searchResult.reviewCount}">0</span>
                        <span> 건</span>
                    </div>
                    <div class="result-sort">
                        <a href="#none"><span>최신순</span></a>
                        <a href="#none"><span>평점순</span></a>
                    </div>
                    <div class="comments_box">
                        <strong class="total_comment">전체
                            <span class="color_b" th:text="${searchResult.reviewCount}">0</span></strong>
                        <div class="user_grade_box">
                            <th:block th:each="review : ${searchResult.reviewResults}">
                                <div class="grade_star">
                                    <a th:href="@{'/store/' + ${review.storeId}}" class="search_store_name"
                                       th:text="${review.storeName}">가게명</a>
                                    <div class="grade_star">
                                        <img width="48" height="48"
                                             src="https://img.icons8.com/color/48/filled-star--v1.png"
                                             alt="filled-star--v1" class="icon_star"/>
                                        <em class="num_rate" th:text="${review.rating}">5</em>
                                        <span class="text_score">점</span>
                                    </div>
                                </div>
                                <div class="comment_info">
                                    <p class="text_comment">
                                        <span th:text="${review.reviewText}">리뷰 내용</span>
                                    </p>
                                </div>
                                <div class="unit_info">
                                    <em class="screen_out">작성자 : </em>
                                    <a href="#none" class="link_user">
                                        <div class="inner_user">
                                            <span class="text_username" th:text="${review.memberNickname}">닉네임</span>
                                        </div>
                                    </a>
                                    <span class="bar"></span>
                                    <span class="text_item">별점 : </span>
                                    <span class="text_desc" th:text="${review.rating}">5</span>
                                    <span class="bar"></span>
                                    <span class="text_item">작성일 : </span>
                                    <span class="time_write" th:text="${#dates.format(review.createdAt, 'yyyy.MM.dd')}">2024.09.30.</span>
                                </div>
<!--                                <div class="photo_group">-->
<!--                                    <ul class="list_photo">-->
<!--                                        &lt;!&ndash; 리뷰에 사진이 있는 경우 표시 &ndash;&gt;-->
<!--                                        <th:block th:if="${review.reviewPhoto != null}">-->
<!--                                            <li>-->
<!--                                                <a th:href="@{${review.reviewPhoto}}" class="box_photo">-->
<!--                                                    <img th:src="@{${review.reviewPhoto}}" width="139" height="139"-->
<!--                                                         alt="후기사진" class="img_thumb">-->
<!--                                                </a>-->
<!--                                            </li>-->
<!--                                        </th:block>-->
<!--                                    </ul>-->
<!--                                </div>-->
                                <div class="wrap_util">
                                    <form>
                                        <button type="button" class="comment_user_button">답글</button>
                                        <button type="button" class="comment_user_button">수정</button>
                                        <button type="button" class="comment_user_button">삭제</button>
                                    </form>
                                </div>
                                <hr/>
                            </th:block>
                        </div>
                        <a href="#none" class="link_more">
                            <span class="txt_more">후기 더보기</span>
                            <span class="ico_comm ico_more"></span>
                        </a>
                    </div>
                    <div class="btn-box">
                        <a href="#none">
                            더보기
                        </a>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- 푸터 섹션 -->
<footer>
    <div class="footer-container">
        <!-- 회사 소개 -->
        <div class="footer-section">
            <h4>프로젝트 소개</h4>
            <p>먹코살코은 최고의 맛집 제공하기 위해 최선을 다하고 있습니다.</p>
        </div>
        <!-- 빠른 링크 -->
        <div class="footer-section">
            <h4>빠른 링크</h4>
            <ul>
                <li><a th:href="@{/home}">홈</a></li>
                <li><a th:href="@{/intro}">소개</a></li>
                <li><a th:href="@{/service}">서비스</a></li>
                <li><a th:href="@{/suggestion}">문의</a></li>
            </ul>
        </div>
        <!-- 연락처 -->
        <div class="footer-section">
            <h4>연락처</h4>
            <ul>
                <li>전화: 02-112-7777</li>
                <li>이메일: admin@taste_police.com</li>
                <li>주소: 서울특별시 송파구 중대로 135, 서관 12층</li>
            </ul>
        </div>
        <!-- 소셜 미디어 -->
        <div class="footer-section">
            <h4>소셜 미디어</h4>
            <div class="social-icons">
                <a href="https://www.facebook.com/yourprofile" aria-label="페이스북">
                    <img th:src="@{/images/facebook_icon.png}" alt="Facebook">
                </a>
                <a href="https://www.twitter.com/yourprofile" aria-label="트위터">
                    <img th:src="@{/images/twitter_icon.png}" alt="Twitter">
                </a>
                <a href="https://www.instagram.com/yourprofile" aria-label="인스타그램">
                    <img th:src="@{/images/instagram_icon.png}" alt="Instagram">
                </a>
            </div>
        </div>
    </div>
    <!-- 푸터 하단 정보 -->
    <div class="footer-bottom">
        &copy; 2024 먹코살코. All rights reserved.
    </div>
</footer>

<!-- JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>
<script>
    // 탭 전환 스크립트
    document.getElementById('contentsTab').addEventListener('click', function (e) {
        if (e.target && e.target.nodeName == "A") {
            e.preventDefault();
            document.querySelectorAll('#contentsTab li').forEach(li => li.classList.remove('on'));
            e.target.parentElement.classList.add('on');

            if (e.target.classList.contains('articleTab')) {
                document.getElementById('mArticle').style.display = 'block';
                document.getElementById('mReview').style.display = 'none';
            } else if (e.target.classList.contains('magazineTab')) {
                document.getElementById('mArticle').style.display = 'none';
                document.getElementById('mReview').style.display = 'block';
            }
        }
    });
</script>
</body>
</html>
